TinyMUX 2.1:  CHANGES
Last Update:  January 2002

Major changes that may affect performance and require softcode tweaks:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 -- Signals SIGINT and SIGUSR2 have been swapped. SIGINT now performs a
    @shutdown, and SIGUSR2 drops a .SIG flatfile.
 -- Removed support for VMS, for the port concentrator.
 -- Removed support for many older mail, comsys, and flatfile formats
    related to Pern, MUD, MUSH, and Penn.
 -- dbconvert now only support three options: Load, Unload, and Check.
    

Feature Additions:
~~~~~~~~~~~~~~~~~
 -- Support and favor %x ANSI substitutions over %c ANSI substitutions,
    but both are recognized.
 -- Changed PORTS() function to allow a player to get their own port number.
 -- Evaluating comtitles.
 -- comtitle/on and comtitle/off.
 -- LASTIP saves the numerical IP address from the players connection.
 -- @wait/until allows one to give an absolute time stamp.
 -- @wait and @wait/until support fractional seconds (eg. @wait 1.5=<cmd>).
 -- Added command access for UNINSPECTED and NO_UNINSPECTED.
 -- Added %m for 'lastcommand'. Equivalent to %c in MUSH.
 -- Exits can be teleported from room to room instead of taken and dropped.
 -- Added generalized article guessing (see art() and article_rule).
 -- Support 36 global registers instead of 10.
 -- Add TIMEFMT() function.
 -- Added null() and @@(). The former evaluates. The latter doesn't.
 -- Added GetFromLock. Patch from Draken-Korin.
 -- Added autozone configuration option (Bug #194 and Bug #635).
 -- Add CREATED attribute (Bug #555 and #608). Patch from Jake.
 -- Added /instant switch to @destroy. Patch from Jake.
 -- Added ability to turn off automatic execution of STARTUP attributes from
    the configuration file. Patch from Jake.
 -- Added safe_wipe configuration option. If enabled, @wipe will not wipe
    SAFE-marked objects. Patch from Jake.
 -- Added destroy_going_now configuration option. If enabled, a second
    @destroy request causes the object to be destroyed immediately.
    Added to provide compatibility with PennMUSH. Patch from Jake.
 -- Win32 builds running on NT are now able to catch the WM_CLOSE messages
    and @shutdown the server cleanly. Running on Win9x does not have this
    ability, yet.
 -- Attributes are now output in numeric order. With this, it is now
    possible to make reasonable-sized patches between two flatfiles.
 -- Added MEMORY_ACCOUNTING routines that match malloc/free calls, detect
    memory leaks, account for which lines of code are allocating and
    deallocating memory, validating the malloc/free protocol itself. It does
    not catch memory overwrites.
 -- Changed message for @chown to give enough information to a builder to
    check their work. It's something of an audit trail.
 -- Added optional output delimeter to SORT(). Patch from Ashen-Shugar.
 -- Enhanced Page command.
 -- Roy Anger's comsys help update.
 -- Reformated wizhelp.txt
 -- Freshened help for @aconnect and @disconnect.
 -- Support second argument for squish().
 -- attrcnt() function from Jake.
 -- ctime() function from Jake.
 -- Added ability for the server to listen to multiple ports and for changes
    to the 'port' config to take affect across a @restart.
 -- Will now accept '@set FooBar=COMMANDS' and '@set FooBar=!COMMANDS'. BLEED
    and SPOOF also added. 'hasflag(FooBar,COMMANDS)' also supported.
 -- Added LOCALIZE().
 -- Added function invocation limit checking for various loop functions:
    ITER, PARSE, MIX, FILTER, FOLD, MAP, etc.
 -- Clean cygwin builds on Win32 with support for @restart.
 -- Remove support for the COMPRESS flag.

Bug Fixes:
~~~~~~~~~
 -- inet_addr() re-write to handle netmask of 255.255.255.255 and Berkeley
    a, a.b, and a.b.c numeric IP formats.
 -- article_rule wasn't parsed correctly, and art() always returned 'a'.
 -- @cboot would SIGSEGV on @cset/anon channels.
 -- Documented comtitle/{on,off}.
 -- Typo bug in RADIX_COMPRESSION build.
 -- Short version string contained 'Alpha' instead of 'Beta'.
 -- Several semaphores waiting on the same object/attr could be @notified
    out of order.
 -- Channel messages are considered OOC.
 -- Bug #662 - SIGSEGV in @dbck.
 -- Bug #618 - Logic in new_home enables being inside a garbage object.
 -- Bug #424 - Linking deposit refund. Patch from Jake.
 -- Bug #585 - Parent isn't cleared during @destroy process. Patch from Jake.
 -- Bug #765 - whispering to objects with ears should still be allowed.
 -- Document safer_passwords configuration option.
 -- Bug #602 - fun_ansi reaches backwards into the buffer.
 -- Bug #391 - WIZARD player could set attributes on garbage objects.
 -- Fixed SIZEOF__LONG typo in code that would be very unlikely to affect any
    platform.
 -- Added optional 4th argument (indent) to COLUMNS().
 -- Removed unintialized have_macros config option. Could have been an
    issue if you were running a non-DEBUG build and wanted to disable the
    comsys.
 -- Fixed SIGBUS issue on Solaris. This was not an issue for MUX 2.0.
    Thanks to nails for providing a Solaris test account.
 -- Fixed SIGSEGV bug in timeutil with how the timezone offset table was
    maintained. It required three things to happen at the same time.
 -- Fixed memory leak of Bools upon a @backup or @dump/flatfile. Bug
    originated in MUX 1.6, first fixed in Chaotic MUX, and is already
    fixed in MUSH 3.0.
 -- Left out a definition for SMALLEST_INT_GTE_NEG_QUOTIENT on Win32 which
    affected FLOORDIV, REMAINDER, and dates with negative years. The
    ./configure process on Unix builds it's own autoconf.h file. This is not
    an issue for those running on Unix.
 -- Fixed a vicious heap-corrupting bug in HASH_ProcessBuffer (demonstrated
    in MUX 2.1.3.23 Unix-only). My bug.
 -- Bug #786 - Logging of commands by players set suspect now works. Patch
    from Shawn Wagner.
 -- '@mail/' was interpreted as '@mail/abort'. Reported by Cloud@Ashes.
 -- Bug #404 - Support 'page =Hi there. =)'. Reported by Silk.
 -- Recognize '@teleport Foo=' and issue an error message instead of
    attempting '@teleport Foo'.
 -- Fixed bug introduced in 2.1.4.25 where '@create Foo' was not accepted.
 -- Flatten random distribution in how similarly-named things are matched.
 -- Include resident memory again in @list process report.
 -- Use mudstate.logging again.
 -- Remove vestigates of macros.
 -- Handle prematurely-chopped comsys.db files.
 -- Bug #548 - DS_AUTODARK was broken for multiple connections.

Performance Enhancements:
~~~~~~~~~~~~~~~~~~~~~~~~
 -- Parser is faster in recognizing %-escapes.
 -- Parser function handling is improved with minimum and maximum range
    checking handled in the parser and not in each individual function.
 -- Database and hashtables use a different hash function which is easier
    for gcc to optimize and therefore, Unix distro should benefit.
    Actually, new hash function is faster than anything else I've found
    for all block sizes from 1-byte up.
 -- For string search with GREP and GREPI, added a Boyer-Moore-Horspool
    string search algorithm for speed.
 -- Perform one strip_ansi() call in do_decomp instead of several.
 -- Remove fourth argument to safe_copy_buf to reduce code size. The 4th
    argument was always LBUF_SIZE-1.
 -- Simplify the varargs_preample family of #defines further.
 -- Use MUXCLI on both Unix and Win32 builds instead of getopt on Unix
    and correct-but-inflexible code on Win32.
 -- Improve performance of pool_alloc and pool_free.
 -- Improve performance of @aconnnect/@adisconnect.
 -- Reduce code size by around 4KB by specializing a few calls.
 -- Improve parser performance by making certain tables 'static const' or
    'const'.
 -- Reduce stack frame per-invocation overhead of TinyExec() by 688 bytes to
    138 bytes.
 -- Improve putstring() performance and therefore @dumps.
 -- Improved parser speed by a few instructions.
 -- Improve speed of TRANSLATE() and emit %t for hardtabs.
 -- Use /dev/urandom on Unix and Crypto API on Win32 to seed the random
    number generator. Fall back gracefully on pre-OSR2 Win95 to previous
    time/pid scheme.

Cosmetic Changes:
~~~~~~~~~~~~~~~~
 -- Consistent file headers and comment blocks. Remove trailing spaces and
    hardtabs.
 -- Remove unused sections of #ifdef'ed out code.

Miscellaneous:
~~~~~~~~~~~~~
 -- Added Manual in LaTeX format.
